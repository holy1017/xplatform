--  1 --
SELECT 
ENAME
,SAL
,COMM
,(SAL+COMM) AS 총액
FROM EMP 
WHERE COMM IS NOT NULL
ORDER BY 총액 DESC;

--  2--
SELECT 
ENAME,
SAL,
SAL*0.13,
DEPTNO
FROM EMP
WHERE
DEPTNO=10;

--  3 --
SELECT 
ENAME,
DEPTNO,
SAL,
SAL*12+SAL*1.5 AS 연봉
FROM EMP
WHERE
DEPTNO=30;

--  4 --
SELECT 
ENAME
,SAL
,ROUND(SAL/12/5,1) AS "시간당 임금"
FROM EMP
WHERE
DEPTNO=20;

--  5 --
SELECT 
ENAME,
SAL,
ROUND(SAL*.15,2) AS 회비
FROM EMP
WHERE
SAL BETWEEN 1500 AND 3000
;

--  6 --
SELECT 
ENAME,
SAL,
ROUND(SAL*.15) AS 경조비
FROM EMP
WHERE
SAL >=2000
;

--  7 --
SELECT 
DEPTNO,
ENAME,
HIREDATE,
SYSDATE,
FLOOR(SYSDATE-HIREDATE) AS 근무일,
FLOOR((SYSDATE-HIREDATE)/365) AS 근무년수,
FLOOR((SYSDATE-HIREDATE)/30) AS 근무월수,
FLOOR((SYSDATE-HIREDATE)/7) AS 근무주수
FROM EMP
;

--  8 --
SELECT
ENAME
,SAL
,SAL*0.9 AS 실수령액
FROM EMP ;

-- 9 --
SELECT
ENAME,
HIREDATE,
HIREDATE+90,
SAL
FROM EMP 
;

-- 10 --
SELECT
HIREDATE,
ADD_MONTHS(HIREDATE,6),
SAL
FROM EMP 
;

--  11  --
SELECT
DEPTNO,
ENAME,
--HIREDATE,
--LAST_DAY(HIREDATE),
LAST_DAY(HIREDATE)-HIREDATE+1 AS 근무일수
FROM EMP 
;

-- 12 --
SELECT
ENAME,
HIREDATE,
NEXT_DAY(HIREDATE+60,2) AS MONDAY
FROM EMP 
;

-- 13 --
SELECT
ENAME,
HIREDATE,
TRUNC(SYSDATE)-HIREDATE+1 AS 근무일수
FROM EMP 
;


-- 14 --
SELECT
ENAME,
TO_CHAR(HIREDATE,'YYYY"년 "MM"월 "DD"일"' )
FROM EMP 
;
--SELECT TO_CHAR(SYSDATE, 'YYYY')||"년"||TO_CHAR(SYSDATE, 'MONTH') "Name of month" FROM DUAL;

-- 15 --
SELECT
--ENAME,
LOWER (SUBSTR(ENAME,0,3))
FROM EMP
WHERE
LENGTH(ENAME)>=6
;

-- 16 --
SELECT
AVG(SAL),
MAX(SAL),
MIN(SAL),
COUNT(EMPNO)
--EMPNO
FROM EMP
WHERE
DEPTNO=10
GROUP BY DEPTNO
;


--  17  --
SELECT
AVG(SAL),
MAX(SAL),
MIN(SAL),
COUNT(EMPNO)
--EMPNO
FROM EMP
GROUP BY DEPTNO
;

-- 18 --
SELECT
DEPTNO
,job
,count(1)
--EMPNO
FROM EMP
GROUP BY DEPTNO,job
;
-- 19 --
SELECT
job
,count(1)
--EMPNO
FROM EMP
GROUP BY job
having count(job)>=4
;
-- 20 --
SELECT
round(avg(sal)) as 평균월급
,sum(sal)
,max(sal)
,min(sal)
FROM EMP
GROUP BY DEPTNO
--having count(job)>=4
order by 평균월급
;